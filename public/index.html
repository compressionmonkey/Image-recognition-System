<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Receipt Recognition</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

    <script src="/index.js" defer></script>

    <link rel="icon" href="data:,">
</head>
<body>
    <div id="loginOverlay" class="login-container">
        <div class="login-card">
            <div class="logo-circle">
                LOGO
            </div>
            <h2>Welcome to Tshong AI</h2>
            <p class="subtitle">Simplify your financial tracking with our easy-to-use receipt scanning app. Capture, organize, and manage your expenses effortlessly.</p>
            
            <div class="features">
                <div class="feature-item">
                    <span class="icon">üì∏</span>
                    <span>Snap photos of your receipts</span>
                </div>
                <div class="feature-item">
                    <span class="icon">üìÑ</span>
                    <span>Automatically extract receipt numbers</span>
                </div>
                <div class="feature-item">
                    <span class="icon">üìä</span>
                    <span>Track and manage your expenses</span>
                </div>
            </div>

            <input type="text" id="customerID" class="login-input" placeholder="Enter Customer ID">
            <button id="login-button" onclick="validateLogin()" class="login-button">
                <span id="loginSpinner" class="spinner" style="display: none;"></span>
                Login
            </button>
            <p id="loginMessage" class="error-message"></p>
            
            <p class="terms">By continuing, you agree to our <a href="https://www.google.com">Terms of Service</a> and <a href="#">Privacy Policy</a>.</p>
        </div>
    </div>

    <div id="mainContent" style="display: none;">
        <div id="userNav">
            <div class="nav-left">
                <button id="fileHistoryBtn" class="nav-button primary" onclick="showRecentFiles()">
                    <span class="icon">üìÅ</span> File History
                </button>
            </div>
            <div class="nav-right">
                <button id="dashboardButton" class="nav-button secondary" onclick="routeUser()">
                    <span class="icon">üìä</span> View Dashboard
                </button>
            </div>
        </div>
        <div class="action-buttons">
            <button id="addPhotoBtn" class="action-button photo-button" onclick="window.showPhotoOptions()">
                <span class="icon">üì∏</span> Add ReceiptPhoto
            </button>
            <button id="addCashBtn" class="action-button cash-button" onclick="window.showManualEntryModal()">
                <span class="icon">üí∞</span> Add Cash Receipt
            </button>
        </div>
    </div>


    <!-- Add this before </body> -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content" id="confirmationModalContent">
            <div class="modal-header">
                <div class="drag-handle" id="dragHandle">
                    <span class="drag-icon">‚ò∞</span>
                </div>
            </div>
        <div class="modal-content">
            <button class="close-btn" onclick="closeConfirmationModal()">&times;</button>
            <!-- <div class="question-icon">‚ùì</div>
            <h2>Is this the correct details?</h2> -->
            <form id="confirmationForm">
                <div class="form-group">
                    <label>Amount (Nu.)</label>
                    <input type="number" 
                           id="confirmAmount" 
                           min="0" 
                           step="0.01" 
                           placeholder="Nu. 0.00"
                           required>
                </div>
                <div class="form-group">
                    <label>Reference Number</label>
                    <input type="text" 
                           id="confirmReference" 
                           placeholder="Enter reference number"
                           required>
                </div>
                <div class="form-group">
                    <label>Particulars</label>
                    <input type="text" 
                           id="confirmParticulars" 
                           placeholder="Enter Particulars"
                           required>
                </div>
                <div class="form-group">
                    <label>Date of Receipt</label>
                    <input type="date" 
                           id="confirmDate" 
                           required>
                    <div id="dateValidationMessage" class="date-validation-message" style="display: none;">
                        Receipt Date is not today. Are you sure you want to add this?
                    </div>
                </div>

                <div id="confirmRemarksField" class="form-group" style="display: none;">
                    <label for="confirmRemarks">Remarks</label>
                    <input type="text" 
                           id="confirmRemarks" 
                           name="confirmRemarks" 
                           placeholder="Enter Remarks"
                           style="box-sizing: border-box;">
                </div>
                
                <div id="confirmDiningField" class="form-group" style="display: none;">
                    <div class="dining-field">
                        <input type="checkbox" 
                               id="confirmDiningCheck" 
                               name="confirmDining">
                        <label for="confirmDiningCheck">Dining</label>
                    </div>
                </div>
                
                <div class="button-group">
                    <button type="button" class="primary-button" onclick="handleConfirmDetails()">Confirm Details</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add this for photo options modal -->
    <div id="photoOptionsModal" class="photo-options-modal" style="display: none;">
        <div class="modal-content">
            <button onclick="handlePhotoOption('camera')" class="photo-option-btn">
                <span class="icon">üì∏</span>
                Take Photo
            </button>
            <button onclick="handlePhotoOption('gallery')" class="photo-option-btn">
                <span class="icon">üñºÔ∏è</span>
                Choose from Gallery
            </button>
            <button onclick="closePhotoOptions()" class="cancel-btn">Cancel</button>
        </div>
    </div>

    <!-- Add this before </body> alongside the success modal -->
    <div id="failureModal" class="failure-modal" style="display: none;">
        <div class="failure-content">
            <!-- Content will be dynamically updated -->
        </div>
    </div>

    <!-- Manual Receipt Entry Modal -->
    <div id="manualEntryModal" class="photo-options-modal" style="display: none;">
        <div class="modal-content">
            <button class="close-btn" onclick="closeManualEntryModal()">&times;</button>
            <h3>Add Cash Receipt</h3>
            <form id="manualReceiptForm">
                <div class="form-group">
                    <label for="amount">Amount (Nu.)</label>
                    <input type="number" 
                           id="amount" 
                           name="amount" 
                           step="1" 
                           min="0" 
                           required 
                           placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label for="particulars">Particulars</label>
                    <input type="text" 
                           id="particulars" 
                           name="particulars" 
                           required 
                           placeholder="Enter Particulars"
                           style="box-sizing: border-box;">
                </div>

                <button type="button" class="photo-option-btn" style="background: #000 !important; color: white !important;" onclick="handleManualSubmit()">
                    <span class="icon" style="color: white !important;">üíæ</span>
                    Submit
                </button>
            </form>
        </div>
    </div>

    <!-- Multiple Uploads Modal Template -->
    <div id="multipleUploadsModal" class="multiple-uploads-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Multiple Payments</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="uploads-container" id="uploadsContainer">
                <!-- Image entries will be added here dynamically -->
            </div>
            <div class="modal-footer">
                <!-- <button class="add-more-btn" id="addAnotherPayment">
                    <span class="plus-icon">+</span> Add Another Payment
                </button> -->
                <button class="submit-all-btn" id="submitAllUploads" onclick="handleSubmitAll()">Submit All</button>
            </div>
        </div>
    </div>

    <!-- Image Entry Template (hidden, will be cloned by JS) -->
    <template id="imageEntryTemplate">
        <div class="image-entry">
            <div class="image-preview">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWltYWdlIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHg9IjMiIHk9IjMiIHJ4PSIyIiByeT0iMiIvPjxjaXJjbGUgY3g9IjguNSIgY3k9IjguNSIgcj0iMS41Ii8+PHBvbHlsaW5lIHBvaW50cz0iMjEgMTUgMTYgMTAgNSAyMSIvPjwvc3ZnPg==" alt="Receipt Preview">
                <button class="delete-btn">&times;</button>
            </div>
            <div class="entry-details">
                <div class="form-group">
                    <label>Amount</label>
                    <div class="input-with-icon">
                        <input type="number" class="amount-input" placeholder="0.00" step="0.01" min="0" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Reference</label>
                    <input type="text" class="reference-input" placeholder="Enter reference">
                </div>
                <div class="form-group">
                    <label>Particulars</label>
                    <input type="text" class="particulars-input" placeholder="Enter details">
                </div>
                <div class="form-group">
                    <label>Date</label>
                    <div class="date-input-container">
                        <input type="date" class="date-input" required>
                    </div>
                </div>
            </div>
        </div>
    </template>

</body>
</html>